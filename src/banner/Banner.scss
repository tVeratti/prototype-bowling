@import '../shared/transitions';
@import '../shared/colors';

$offset-left: 25%;
$size-ball: 45vh;
$size-pin: 45vh;
$size-total: 85rem;
$position-left: 15%;

.banner__graphics {
  position: fixed;
  left: 50%;
  transform: translateX(-40rem);
}

.ball {
  position: absolute;
  width: $size-ball;
  height: $size-ball;
  left: $position-left;
  z-index: 2;
  transform: translate(20rem, 50rem);
  fill: mix($base, black, 60%);
}

.pin {
  position: absolute;
  width: $size-pin;
  height: $size-pin;
  stroke-width: 3px;
  filter: drop-shadow(2px 2px 5px rgba(black, 0.2));
}

.banner__row {
  position: absolute;
  left: $position-left;

  // Place pins in 4 rows, offsetting
  // each a tiny bit higher.
  /**
    * - - - -   :nth-child(0) 0%
    *  - - -    :nth-child(1) 10%
    *   - -     :nth-child(2) 20%
    *    -      :nth-child(3) 30%
    */
  @for $i from 1 through (4) {
    $pin-color-hue: hsl($i * 50, 90%, ($i + 2) * 10%);
    $pin-color-bw: mix(white, mix($primary, $base, 30%), ($i + 1) * 20);
    $pin-color-tra: rgba($contrast, $i * 0.2);
    $pin-timer: (4 - $i) * 0.2s;

    // Vertical offset
    &:nth-child(#{$i}) {
      top: $i * 8rem;

      // Horizontal offset
      svg {
        @for $j from 1 through (4) {
          &:nth-child(#{$j}) {
            left: $j * 10rem;
            fill: $pin-color-bw;
          }
        }
      }
    }
  }

  // Explodey rotations
  // prettier-ignore
  @mixin explode($row, $col, $x: 0, $y: 0, $deg: 0, $scale: 1) {
    @keyframes explode-#{$row}-#{$col} {
      0% {
        transform:
          translate(($x/2) * 1vh, ($y/2) * 0.5vh)
          rotate(($deg/2))
          scale($scale);
      }

      100% {
        transform:
          translateX($x * 1vh)
          translateY($y * 0.5vh)
          rotate($deg)
          scale($scale);
      }
    }

    &:nth-child(#{$row}) svg:nth-child(#{$col}) {
      animation: explode-#{$row}-#{$col} 4s infinite paused alternate;
    }
  }

  // Row (1 pin)
  @include explode(4, 1, -30, 3, -70deg, 1.5);
  // Row (2 pins)
  @include explode(3, 1, -25, -8, -45deg, 1.4);
  @include explode(3, 2, 40, 8, 55deg, 1.4);
  // Row (3 pins)
  @include explode(2, 1, -6, -10, -25deg);
  @include explode(2, 2, 5, -11, 10deg, 1.2);
  @include explode(2, 3, 15, 2, 45deg, 0.9);
  // Row (4 pins)
  @include explode(1, 1, 3, -15, -10deg, 0.6);
  @include explode(1, 2, 12, 1, 20deg, 0.7);
  @include explode(1, 3, 10, 5, 40deg, 0.6);
  @include explode(1, 4, 20, 10, 60deg, 0.7);

  // &:nth-child(1) {
  //   filter: blur(0.2rem);
  // }
  // &:nth-child(2) {
  //   filter: blur(0.1rem);
  // }
}
